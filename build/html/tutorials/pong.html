<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="twitter:site" content="@kivyframework">
    
    <title>Pong Game Tutorial(翻訳中) &mdash; Kivy 1.9.1 ドキュメント</title>
    <link href='//fonts.googleapis.com/css?family=Source+Code+Pro:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="../_static/fresh.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.9.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/jquery-effects-core-and-slide.js"></script>
    <script type="text/javascript" src="../_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="../_static/kivy.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="Kivy 1.9.1 ドキュメント" href="../index.html" />
    <link rel="up" title="Tutorials" href="../tutorials-index.html" />
    <link rel="next" title="A Simple Paint App(翻訳中)" href="firstwidget.html" />
    <link rel="prev" title="Tutorials" href="../tutorials-index.html" /> 
  </head>
  <body>

    <div id="topbar">
        <div id="topwrapper">
        <div id="toplogo">
            <a href="http://kivy.org/">
                <img src="../_static/logo-kivy.png" alt="Kivy" height="50"/>
            </a>
        </div>
        <div id="topmenu">
            <ul class="navigation">
                <li><a class="nav-guides" href="../gettingstarted/intro.html">Guides</a></li>
                <li><a class="nav-garden" href="http://kivy-garden.github.io/">Garden</a></li>
                <li><a class="nav-api" href="../api-kivy.html">API Reference</a></li>
                <li><a class="nav-pdf" href="http://kivy.org/docs/pdf/Kivy-latest.pdf">PDF</a></li>
                <li><a class="nav-wiki" href="http://wiki.kivy.org">Wiki</a></li>
            </ul>
        </div>
        </div>
    </div>
<div id="contentall">
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3>Quick search</h3>
            <form class="search" action="../search.html" method="get">
                &nbsp;
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
                <input type="text" class="text" name="q" />
            </form>
          <!--
          <h3><a href="../index.html">Pong Game Tutorial(翻訳中)</a></h3>
          <ul>
<li><a class="reference internal" href="#">Pong Game Tutorial(翻訳中)</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#getting-started">Getting Started</a></li>
<li><a class="reference internal" href="#add-simple-graphics">Add Simple Graphics</a><ul>
<li><a class="reference internal" href="#explaining-the-kv-file-syntax">Explaining the Kv File Syntax</a></li>
</ul>
</li>
<li><a class="reference internal" href="#add-the-ball">Add the Ball</a><ul>
<li><a class="reference internal" href="#pongball-class">PongBall Class</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-ball-animation">Adding Ball Animation</a><ul>
<li><a class="reference internal" href="#scheduling-functions-on-the-clock">Scheduling Functions on the Clock</a></li>
<li><a class="reference internal" href="#object-properties-references">Object Properties/References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#connect-input-events">Connect Input Events</a></li>
<li><a class="reference internal" href="#where-to-go-now">Where To Go Now?</a></li>
</ul>
</li>
</ul>

          <h3><a href="../index.html">Table Of Contents</a></h3>
          -->
          <ul>
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted/index.html">Getting Started(翻訳中)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/intro.html">導入</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/installation.html">インストール</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/first_app.html">最初のアプリ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/properties.html">プロパティ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/rules.html">Kv デザイン 言語</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/events.html">イベント</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/framework.html">Non-widget stuff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/layouts.html">Layouts(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/drawing.html">描画</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/packaging.html">Packaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/examples.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/diving.html">ダイビング</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Gallery of Examples(翻訳済み)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/gallery.html">Gallery(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__3Drendering__main__py.html">3D Rotating Monkey Head(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__animation__animate__py.html">Widget animation(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__application__app_suite__py.html">Suite of Application Builders(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__application__app_with_build__py.html">Application example using build() + return(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__application__app_with_kv__py.html">Application built from a  .kv fil(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__application__app_with_kv_in_template1__py.html">Application from a .kv in a Template Directory(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__camera__main__py.html">Camera Example(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__bezier__py.html">Bezier Example(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__canvas_stress__py.html">Canvas stress(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__circle__py.html">Circle Example(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__fbo_canvas__py.html">FBO Canvas(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__lines__py.html">Line (SmoothLine) Experiment(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__lines_extended__py.html">Lines Extended Demo(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__mesh__py.html">Mesh test(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__multitexture__py.html">Multitexture Example(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__repeat_texture__py.html">Repeat Texture on Resize(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__rotation__py.html">Rotation Example(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__stencil_canvas__py.html">Stencil demo(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__tesselate__py.html">Tesselate Demonstration(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__texture__py.html">Texture Wrapping and Coordinates Example(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__demo__camera_puzzle__py.html">Shuffled Camera Feed Puzzle(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__demo__kivycatalog__main__py.html">Kivy Catalog(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__demo__multistroke__main__py.html">Multistroke Recognition Database Demonstration(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__demo__pictures__main__py.html">Basic Picture Viewer(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__demo__shadereditor__main__py.html">Live Shader Editor(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__demo__showcase__main__py.html">Showcase of Kivy Features(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__demo__touchtracer__main__py.html">Touch Tracer Line Drawing Demonstration(翻訳済み)</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user-guide.html">User’s Guide(翻訳中)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation/installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../philosophy.html">Philosophy(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute.html">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contact.html">Contact Us</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guide-index.html">Programming Guide(翻訳中)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../guide/basic.html">Kivyの基本</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide/environment.html">Controlling the environment(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide/config.html">Configure Kivy(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide/architecture.html">Architectural Overview(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide/events.html">Events and Properties (翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide/inputs.html">Input management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide/widgets.html">Widgets(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide/graphics.html">Graphics (翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide/lang.html">Kv language(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide/other-frameworks.html">Integrating with other Frameworks(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide/bestpractices.html">Best Practices(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide/advancedgraphics.html">Advanced Graphics(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide/packaging.html">Packaging your application(翻訳中)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guide/licensing.html">Package licensing(未翻訳)</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials-index.html">Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Pong Game Tutorial(翻訳中)</a></li>
<li class="toctree-l2"><a class="reference internal" href="firstwidget.html">A Simple Paint App(翻訳中)</a></li>
<li class="toctree-l2"><a class="reference internal" href="crashcourse.html">Crash Course</a></li>
</ul>
</li>
</ul>

          <!--
          <h3>Related Topics</h3>
          <ul>
              <li>Previous: <a href="../tutorials-index.html" title="previous chapter">Tutorials</a></li>
              <li>Next: <a href="firstwidget.html" title="next chapter">A Simple Paint App(翻訳中)</a></li>
          </ul>
          -->
        </div>
      </div>
    <div id="content">
    <div class="wrapper">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            <div class="toc"><h2>Table Of Contents</h2><ul>
<li><a class="reference internal" href="#">Pong Game Tutorial(翻訳中)</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#getting-started">Getting Started</a></li>
<li><a class="reference internal" href="#add-simple-graphics">Add Simple Graphics</a><ul>
<li><a class="reference internal" href="#explaining-the-kv-file-syntax">Explaining the Kv File Syntax</a></li>
</ul>
</li>
<li><a class="reference internal" href="#add-the-ball">Add the Ball</a><ul>
<li><a class="reference internal" href="#pongball-class">PongBall Class</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-ball-animation">Adding Ball Animation</a><ul>
<li><a class="reference internal" href="#scheduling-functions-on-the-clock">Scheduling Functions on the Clock</a></li>
<li><a class="reference internal" href="#object-properties-references">Object Properties/References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#connect-input-events">Connect Input Events</a></li>
<li><a class="reference internal" href="#where-to-go-now">Where To Go Now?</a></li>
</ul>
</li>
</ul>
</div>
            
  <div class="section" id="pong-game-tutorial">
<h1>Pong Game Tutorial(翻訳中)<a class="headerlink" href="#pong-game-tutorial" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="title container">
<p>ようこそポンのチュートリアルへ</p>
</div>
<p>このチュートリアルでは、Kivyを使ってポンゲームを作成する方法を教えます。私たちは、アプリケーションを作成で説明したようなアプリケーションの基礎(<a class="reference internal" href="../guide/basic.html#quickstart"><span class="std std-ref">アプリケーションを作成する</span></a>)から始めましょう。そして、プレイすることが可能なポンゲームを各工程に沿って説明します。</p>
<a class="reference internal image-reference" href="../_images/pong.jpg"><img alt="../_images/pong.jpg" class="align-center" src="../_images/pong.jpg" style="height: 392px;" /></a>
<p>まず、チュートリアルを開始する前に以下をチェックしてください:</p>
<ul class="simple">
<li><p class="first">Kivyをインストールしていますか？ 詳細な説明は <a class="reference internal" href="../installation/installation.html"><span class="doc">Installation</span></a>  の項を参照してください。</p>
</li>
<li><p class="first">基本的なKivyのアプリケーションの実行方法をしていますか？ わからない場合は、<a class="reference internal" href="../guide/basic.html#quickstart"><span class="std std-ref">アプリケーションを作成する</span></a> を参照してください。</p>
</li>
</ul>
<p>If you have read the programming guide, and understand both basic Widget
concepts (<a class="reference internal" href="firstwidget.html"><span class="doc">A Simple Paint App(翻訳中)</span></a>) and basic concepts of the kv language
(<a class="reference internal" href="../guide/lang.html"><span class="doc">Kv language(翻訳済み)</span></a>), you can probably skip the first 2
steps and go straight to step 3.</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">You can find the entire source code, and source code files for each step in
the Kivy examples directory under <cite>tutorials/pong/</cite></p>
</div>
<p>Ready? Sweet, let&#8217;s get started!</p>
</div>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="title container">
Getting Started</div>
<p>Let&#8217;s start by getting a really simple Kivy app up and running. Create a
directory for the game and a file named <em>main.py</em></p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kivy.app</span> <span class="kn">import</span> <span class="n">App</span>
<span class="kn">from</span> <span class="nn">kivy.uix.widget</span> <span class="kn">import</span> <span class="n">Widget</span>


<span class="k">class</span> <span class="nc">PongGame</span><span class="p">(</span><span class="n">Widget</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">PongApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">PongGame</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">PongApp</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>Go ahead and run the application. It should just show a black window at this
point. What we&#8217;ve done is create a very simple Kivy <code class="xref py py-class docutils literal"><span class="pre">App</span></code>,
which creates an instance of our <code class="docutils literal"><span class="pre">PongGame</span></code> Widget class and returns it as
the root element for the applications UI, which you should imagine at this
point as a hierarchical tree of Widgets. Kivy places this widget-tree in the
default Window. In the next step, we will draw the
Pong background and scores by defining how the <code class="docutils literal"><span class="pre">PongGame</span> <span class="pre">widget</span></code> looks.</p>
</div>
<div class="section" id="add-simple-graphics">
<h2>Add Simple Graphics<a class="headerlink" href="#add-simple-graphics" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="title container">
Creation of pong.kv</div>
<p>We will use a .kv file to define the look and feel of the <code class="docutils literal"><span class="pre">PongGame</span></code> class.
Since our <code class="xref py py-class docutils literal"><span class="pre">App</span></code> class is called <code class="docutils literal"><span class="pre">PongApp</span></code>, we can simply create a file
called <code class="docutils literal"><span class="pre">pong.kv</span></code> in the same directory that will be automatically loaded
when the application is run. So create a new file called <em>``pong.kv``</em> and add
the following contents.</p>
<div class="highlight-kv"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#:kivy 1.0.9</span>

<span class="nn">&lt;PongGame&gt;</span><span class="p">:</span>    
    <span class="nc">canvas</span><span class="p">:</span>
        <span class="nc">Rectangle</span><span class="p">:</span>
            <span class="na">pos</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">center_x</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span>
            <span class="na">size</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>
            
    <span class="nc">Label</span><span class="p">:</span>
        <span class="na">font_size</span><span class="p">:</span> <span class="mi">70</span>  
        <span class="na">center_x</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mi">4</span>
        <span class="na">top</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">top</span> <span class="o">-</span> <span class="mi">50</span>
        <span class="na">text</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span>
        
    <span class="nc">Label</span><span class="p">:</span>
        <span class="na">font_size</span><span class="p">:</span> <span class="mi">70</span>  
        <span class="na">center_x</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span>
        <span class="na">top</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">top</span> <span class="o">-</span> <span class="mi">50</span>
        <span class="na">text</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">COMMON ERROR: The name of the kv file, e.g. pong.kv, must match the name of the app,
e.g. PongApp (the part before the App ending).</p>
</div>
<p>If you run the app now, you should see a vertical bar in the middle, and two
zeros where the player scores will be displayed.</p>
<div class="section" id="explaining-the-kv-file-syntax">
<h3>Explaining the Kv File Syntax<a class="headerlink" href="#explaining-the-kv-file-syntax" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Before going on to the next step, you might want to take a closer look at
the contents of the kv file we just created and figure out what is going on.
If you understand what&#8217;s happening, you can probably skip ahead to the next
step.</p>
<p>On the very first line we have:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1">#:kivy 1.0.9</span>
</pre></div>
</div>
<p>This first line is required in every kv file. It should start with <code class="docutils literal"><span class="pre">#:kivy</span></code>
followed by a space and the Kivy version it is intended for (so Kivy can make
sure you have at least the required version, or handle backwards compatibility
later on).</p>
<p>After that, we begin defining rules that are applied to all <code class="docutils literal"><span class="pre">PongGame</span></code>
instances:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">PongGame</span><span class="o">&gt;</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Like Python, kv files use indentation to define nested blocks. A block defined
with a class name inside the <code class="docutils literal"><span class="pre">&lt;</span></code> and <code class="docutils literal"><span class="pre">&gt;</span></code> characters is a
<code class="xref py py-class docutils literal"><span class="pre">Widget</span></code> rule. It will be applied to any instance of
the named class. If you replaced <code class="docutils literal"><span class="pre">PongGame</span></code> with <code class="docutils literal"><span class="pre">Widget</span></code> in our example, all
Widget instances would have the vertical line and the two Label widgets inside
them because it would define these rules for all Widget instances.</p>
<p>Inside a rule section, you can add various blocks to define the style and
contents of the widgets they will be applied to. You can:</p>
<ul class="simple">
<li>set property values,</li>
<li>add child widgets</li>
<li>define a <cite>canvas</cite> section in which you can add Graphics instructions that
define how the widget is rendered.</li>
</ul>
<p>The first block inside the <code class="docutils literal"><span class="pre">&lt;PongGame&gt;</span></code> rule we have is a <cite>canvas</cite> block:</p>
<div class="highlight-kv"><div class="highlight"><pre><span></span><span class="nn">&lt;PongGame&gt;</span><span class="p">:</span>
    <span class="nc">canvas</span><span class="p">:</span>
        <span class="nc">Rectangle</span><span class="p">:</span>
            <span class="na">pos</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">center_x</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span>
            <span class="na">size</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>
</pre></div>
</div>
<p>So this canvas block says that the <code class="docutils literal"><span class="pre">PongGame</span></code> widget should draw some
graphics primitives. In this case, we add a rectangle to the canvas. We set
the pos of the rectangle to be 5 pixels left of the horizontal center of
the widget, and 0 for y. The size of the rectangle is set to 10 pixels
in width, and the widget&#8217;s height in height. The nice thing about defining the
graphics like this, is that the rendered rectangle will be automatically
updated when the properties of any widgets used in the value expression change.</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">Try to resize the application window and notice what happens. That&#8217;s
right, the entire UI resizes automatically. The standard behaviour of the
Window is to resize an element based on its property <cite>size_hint</cite>. The
default widget size_hint is (1,1), meaning it will be stretched 100% in both
x-direction and y-direction and hence fill the available space.
Since the pos and size of the rectangle and center_x and top of the score
labels were defined within
the context of the <code class="docutils literal"><span class="pre">PongGame</span></code> class, these properties will automatically
update when the corresponding widget properties change. Using the Kv
language gives you automatic property binding. :)</p>
</div>
<p>The last two sections we add look pretty similar. Each of them adds a Label
widget as a child widget to the <code class="docutils literal"><span class="pre">PongGame</span></code> widget. For now, the text on
both of them is just set to <em>&#8220;0&#8221;</em>. We&#8217;ll hook that up to the actual
score once we have the logic implemented, but the labels already
look good since we set a bigger font_size, and positioned them relatively
to the root widget. The <code class="docutils literal"><span class="pre">root</span></code> keyword can be used inside the child block to
refer back to the parent/root widget the rule applies to (<code class="docutils literal"><span class="pre">PongGame</span></code> in this
case):</p>
<div class="highlight-kv"><div class="highlight"><pre><span></span><span class="nn">&lt;PongGame&gt;</span><span class="p">:</span>
    <span class="c1"># ...</span>

    <span class="nc">Label</span><span class="p">:</span>
        <span class="na">font_size</span><span class="p">:</span> <span class="mi">70</span>
        <span class="na">center_x</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mi">4</span>
        <span class="na">top</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">top</span> <span class="o">-</span> <span class="mi">50</span>
        <span class="na">text</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span>

    <span class="nc">Label</span><span class="p">:</span>
        <span class="na">font_size</span><span class="p">:</span> <span class="mi">70</span>
        <span class="na">center_x</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span>
        <span class="na">top</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">top</span> <span class="o">-</span> <span class="mi">50</span>
        <span class="na">text</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="add-the-ball">
<h2>Add the Ball<a class="headerlink" href="#add-the-ball" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="title container">
Add the Ball</div>
<p>Ok, so we have a basic pong arena to play in, but we still need the players and
a ball to hit around.  Let&#8217;s start with the ball.  We&#8217;ll add a new <cite>PongBall</cite>
class to create a widget that will be our ball and make it bounce around.</p>
<div class="section" id="pongball-class">
<h3>PongBall Class<a class="headerlink" href="#pongball-class" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Here is the Python code for the PongBall class:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PongBall</span><span class="p">(</span><span class="n">Widget</span><span class="p">):</span>

    <span class="c1"># velocity of the ball on x and y axis</span>
    <span class="n">velocity_x</span> <span class="o">=</span> <span class="n">NumericProperty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">velocity_y</span> <span class="o">=</span> <span class="n">NumericProperty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># referencelist property so we can use ball.velocity as</span>
    <span class="c1"># a shorthand, just like e.g. w.pos for w.x and w.y</span>
    <span class="n">velocity</span> <span class="o">=</span> <span class="n">ReferenceListProperty</span><span class="p">(</span><span class="n">velocity_x</span><span class="p">,</span> <span class="n">velocity_y</span><span class="p">)</span>

    <span class="c1"># ``move`` function will move the ball one step. This</span>
    <span class="c1">#  will be called in equal intervals to animate the ball</span>
    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">velocity</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
</pre></div>
</td></tr></table></div>
<p>And here is the kv rule used to draw the ball as a white circle:</p>
<div class="highlight-kv"><div class="highlight"><pre><span></span><span class="nn">&lt;PongBall&gt;</span><span class="p">:</span>
    <span class="na">size</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span>
    <span class="nc">canvas</span><span class="p">:</span>
        <span class="nc">Ellipse</span><span class="p">:</span>
            <span class="na">pos</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
            <span class="na">size</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
<p>To make it all work, you also have to add the imports for the
<span class="xref doc">/api-kivy.properties</span> Property classes used and the
<code class="xref py py-class docutils literal"><span class="pre">Vector</span></code>.</p>
<p>Here is the entire updated python code and kv file for this step:</p>
<dl class="docutils">
<dt>main.py:</dt>
<dd><div class="first last highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kivy.app</span> <span class="kn">import</span> <span class="n">App</span>
<span class="kn">from</span> <span class="nn">kivy.uix.widget</span> <span class="kn">import</span> <span class="n">Widget</span>
<span class="kn">from</span> <span class="nn">kivy.properties</span> <span class="kn">import</span> <span class="n">NumericProperty</span><span class="p">,</span> <span class="n">ReferenceListProperty</span>
<span class="kn">from</span> <span class="nn">kivy.vector</span> <span class="kn">import</span> <span class="n">Vector</span>


<span class="k">class</span> <span class="nc">PongBall</span><span class="p">(</span><span class="n">Widget</span><span class="p">):</span>
    <span class="n">velocity_x</span> <span class="o">=</span> <span class="n">NumericProperty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">velocity_y</span> <span class="o">=</span> <span class="n">NumericProperty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">velocity</span> <span class="o">=</span> <span class="n">ReferenceListProperty</span><span class="p">(</span><span class="n">velocity_x</span><span class="p">,</span> <span class="n">velocity_y</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">velocity</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>


<span class="k">class</span> <span class="nc">PongGame</span><span class="p">(</span><span class="n">Widget</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span> <span class="nc">PongApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">PongGame</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">PongApp</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</dd>
<dt>pong.kv:</dt>
<dd><div class="first last highlight-kv"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#:kivy 1.0.9</span>

<span class="nn">&lt;PongBall&gt;</span><span class="p">:</span>
    <span class="na">size</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span> 
    <span class="nc">canvas</span><span class="p">:</span>
        <span class="nc">Ellipse</span><span class="p">:</span>
            <span class="na">pos</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
            <span class="na">size</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>          

<span class="nn">&lt;PongGame&gt;</span><span class="p">:</span>
    <span class="nc">canvas</span><span class="p">:</span>
        <span class="nc">Rectangle</span><span class="p">:</span>
            <span class="na">pos</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">center_x</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span>
            <span class="na">size</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>
    
    <span class="nc">Label</span><span class="p">:</span>
        <span class="na">font_size</span><span class="p">:</span> <span class="mi">70</span>  
        <span class="na">center_x</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mi">4</span>
        <span class="na">top</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">top</span> <span class="o">-</span> <span class="mi">50</span>
        <span class="na">text</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span>
        
    <span class="nc">Label</span><span class="p">:</span>
        <span class="na">font_size</span><span class="p">:</span> <span class="mi">70</span>  
        <span class="na">center_x</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span>
        <span class="na">top</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">top</span> <span class="o">-</span> <span class="mi">50</span>
        <span class="na">text</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span>
    
    <span class="nc">PongBall</span><span class="p">:</span>
        <span class="na">center</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">center</span>
        
</pre></div>
</td></tr></table></div>
</dd>
</dl>
<p>Note that not only a <cite>&lt;PongBall&gt;</cite> widget rule has been added, but also a
child widget <cite>PongBall</cite> in the <cite>&lt;PongGame&gt;</cite> widget rule.</p>
</div>
</div>
<div class="section" id="adding-ball-animation">
<h2>Adding Ball Animation<a class="headerlink" href="#adding-ball-animation" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="title container">
Making the ball move</div>
<p>Cool, so now we have a ball, and it even has a <code class="docutils literal"><span class="pre">move</span></code> function... but it&#8217;s not
moving yet. Let&#8217;s fix that.</p>
<div class="section" id="scheduling-functions-on-the-clock">
<h3>Scheduling Functions on the Clock<a class="headerlink" href="#scheduling-functions-on-the-clock" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>We need the <code class="docutils literal"><span class="pre">move</span></code> method of our ball to be called regularly. Luckily, Kivy
makes this pretty easy by letting us schedule any function we want using the
<code class="xref py py-class docutils literal"><span class="pre">Clock</span></code> and specifying the interval:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Clock</span><span class="o">.</span><span class="n">schedule_interval</span><span class="p">(</span><span class="n">game</span><span class="o">.</span><span class="n">update</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">60.0</span><span class="p">)</span>
</pre></div>
</div>
<p>This line for example, would cause the <code class="docutils literal"><span class="pre">update</span></code> function of the game object to
be called once every 60th of a second (60 times per second).</p>
</div>
<div class="section" id="object-properties-references">
<h3>Object Properties/References<a class="headerlink" href="#object-properties-references" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>We have another problem though.  We&#8217;d like to make sure the PongBall has its
<code class="docutils literal"><span class="pre">move</span></code> function called regularly, but in our code we don&#8217;t have any references
to the ball object since we just added it via the kv file
inside the kv rule for the <code class="docutils literal"><span class="pre">PongGame</span></code> class. The only reference to our
game is the one we return in the applications build method.</p>
<p>Since we&#8217;re going to have to do more than just move the ball (e.g.
bounce it off the walls and later the players racket), we&#8217;ll probably need
an <code class="docutils literal"><span class="pre">update</span></code> method for our <code class="docutils literal"><span class="pre">PongGame</span></code> class anyway. Furthermore, given that
we have a reference to the game object already, we can easily schedule its new
<code class="docutils literal"><span class="pre">update</span></code> method when the application gets built:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PongGame</span><span class="p">(</span><span class="n">Widget</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
        <span class="c1"># call ball.move and other stuff</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">PongApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">game</span> <span class="o">=</span> <span class="n">PongGame</span><span class="p">()</span>
        <span class="n">Clock</span><span class="o">.</span><span class="n">schedule_interval</span><span class="p">(</span><span class="n">game</span><span class="o">.</span><span class="n">update</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">60.0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">game</span>
</pre></div>
</td></tr></table></div>
<p>However, that still doesn&#8217;t change the fact that we don&#8217;t have a reference to the
<code class="docutils literal"><span class="pre">PongBall</span></code> child widget created by the kv rule.  To fix this, we can add an
<code class="xref py py-class docutils literal"><span class="pre">ObjectProperty</span></code>
to the PongGame class, and hook it up to the widget created in
the kv rule. Once that&#8217;s done, we can easily reference the ball property
inside the <code class="docutils literal"><span class="pre">update</span></code> method and even make it bounce off the edges:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PongGame</span><span class="p">(</span><span class="n">Widget</span><span class="p">):</span>
    <span class="n">ball</span> <span class="o">=</span> <span class="n">ObjectProperty</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">move</span><span class="p">()</span>

        <span class="c1"># bounce off top and bottom</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1"># bounce off left and right</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
</pre></div>
</td></tr></table></div>
<p>Don&#8217;t forget to hook it up in the kv file, by giving the child widget an id
and setting the PongGame&#8217;s <code class="docutils literal"><span class="pre">ball</span></code> ObjectProperty to that id:</p>
<div class="highlight-kv"><div class="highlight"><pre><span></span><span class="nn">&lt;PongGame&gt;</span><span class="p">:</span>
    <span class="na">ball</span><span class="p">:</span> <span class="n">pong_ball</span>

    <span class="c1"># ... (canvas and Labels)</span>

    <span class="nc">PongBall</span><span class="p">:</span>
        <span class="na">id</span><span class="p">:</span> <span class="n">pong_ball</span>
        <span class="na">center</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">center</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">At this point everything is hooked up for the ball to bounce around. If
you&#8217;re coding along as we go, you might be wondering why the ball isn&#8217;t
moving anywhere.  The ball&#8217;s velocity is set to 0 on both x and y.
In the code listing below, a <code class="docutils literal"><span class="pre">serve_ball</span></code> method is
added to the <code class="docutils literal"><span class="pre">PongGame</span></code> class and called in the app&#8217;s <code class="docutils literal"><span class="pre">build</span></code> method. It sets a
random x and y velocity for the ball, and also resets the position, so we
can use it later to reset the ball when a player has scored a point.</p>
</div>
<p>Here is the entire code for this step:</p>
<dl class="docutils">
<dt>main.py:</dt>
<dd><div class="first last highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kivy.app</span> <span class="kn">import</span> <span class="n">App</span>
<span class="kn">from</span> <span class="nn">kivy.uix.widget</span> <span class="kn">import</span> <span class="n">Widget</span>
<span class="kn">from</span> <span class="nn">kivy.properties</span> <span class="kn">import</span> <span class="n">NumericProperty</span><span class="p">,</span> <span class="n">ReferenceListProperty</span><span class="p">,</span>\
    <span class="n">ObjectProperty</span>
<span class="kn">from</span> <span class="nn">kivy.vector</span> <span class="kn">import</span> <span class="n">Vector</span>
<span class="kn">from</span> <span class="nn">kivy.clock</span> <span class="kn">import</span> <span class="n">Clock</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>


<span class="k">class</span> <span class="nc">PongBall</span><span class="p">(</span><span class="n">Widget</span><span class="p">):</span>
    <span class="n">velocity_x</span> <span class="o">=</span> <span class="n">NumericProperty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">velocity_y</span> <span class="o">=</span> <span class="n">NumericProperty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">velocity</span> <span class="o">=</span> <span class="n">ReferenceListProperty</span><span class="p">(</span><span class="n">velocity_x</span><span class="p">,</span> <span class="n">velocity_y</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">velocity</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>


<span class="k">class</span> <span class="nc">PongGame</span><span class="p">(</span><span class="n">Widget</span><span class="p">):</span>
    <span class="n">ball</span> <span class="o">=</span> <span class="n">ObjectProperty</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">serve_ball</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">velocity</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">move</span><span class="p">()</span>

        <span class="c1">#bounce off top and bottom</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1">#bounce off left and right</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">right</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">velocity_x</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>


<span class="k">class</span> <span class="nc">PongApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">game</span> <span class="o">=</span> <span class="n">PongGame</span><span class="p">()</span>
        <span class="n">game</span><span class="o">.</span><span class="n">serve_ball</span><span class="p">()</span>
        <span class="n">Clock</span><span class="o">.</span><span class="n">schedule_interval</span><span class="p">(</span><span class="n">game</span><span class="o">.</span><span class="n">update</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">60.0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">game</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">PongApp</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</dd>
<dt>pong.kv:</dt>
<dd><div class="first last highlight-kv"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#:kivy 1.0.9</span>

<span class="nn">&lt;PongBall&gt;</span><span class="p">:</span>
    <span class="na">size</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span> 
    <span class="nc">canvas</span><span class="p">:</span>
        <span class="nc">Ellipse</span><span class="p">:</span>
            <span class="na">pos</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
            <span class="na">size</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>          

<span class="nn">&lt;PongGame&gt;</span><span class="p">:</span>
    <span class="na">ball</span><span class="p">:</span> <span class="n">pong_ball</span>
    
    <span class="nc">canvas</span><span class="p">:</span>
        <span class="nc">Rectangle</span><span class="p">:</span>
            <span class="na">pos</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">center_x</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span>
            <span class="na">size</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>
    
    <span class="nc">Label</span><span class="p">:</span>
        <span class="na">font_size</span><span class="p">:</span> <span class="mi">70</span>  
        <span class="na">center_x</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mi">4</span>
        <span class="na">top</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">top</span> <span class="o">-</span> <span class="mi">50</span>
        <span class="na">text</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span>
        
    <span class="nc">Label</span><span class="p">:</span>
        <span class="na">font_size</span><span class="p">:</span> <span class="mi">70</span>  
        <span class="na">center_x</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span>
        <span class="na">top</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">top</span> <span class="o">-</span> <span class="mi">50</span>
        <span class="na">text</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span>
    
    <span class="nc">PongBall</span><span class="p">:</span>
        <span class="na">id</span><span class="p">:</span> <span class="n">pong_ball</span>
        <span class="na">center</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">center</span>
        
</pre></div>
</td></tr></table></div>
</dd>
</dl>
</div>
</div>
<div class="section" id="connect-input-events">
<h2>Connect Input Events<a class="headerlink" href="#connect-input-events" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="title container">
Adding Players and reacting to touch input</div>
<p>Sweet, our ball is bouncing around. The only things missing now are the movable
player rackets and keeping track of the score.  We won&#8217;t go over all the
details of creating the class and kv rules again, since those concepts were
already covered in the previous steps. Instead, let&#8217;s focus on how to move the
Player widgets in response to user input. You can get the whole code and kv
rules for the <code class="docutils literal"><span class="pre">PongPaddle</span></code> class at the end of this section.</p>
<p>In Kivy, a widget can react to input by implementing the
<code class="xref py py-meth docutils literal"><span class="pre">on_touch_down</span></code>, the
<code class="xref py py-meth docutils literal"><span class="pre">on_touch_move</span></code> and the
<code class="xref py py-meth docutils literal"><span class="pre">on_touch_up</span></code>
methods. By default, the Widget class
implements these methods by just calling the corresponding method on all its
child widgets to pass on the event until one of the children returns <code class="docutils literal"><span class="pre">True</span></code>.</p>
<p>Pong is pretty simple. The rackets just need to move up and down. In fact it&#8217;s
so simple, we don&#8217;t even really need to have the player widgets handle the
events themselves. We&#8217;ll just implement the <code class="docutils literal"><span class="pre">on_touch_move</span></code> function for the
<code class="docutils literal"><span class="pre">PongGame</span></code> class and have it set the position of the left or right player based
on whether the touch occurred on the left or right side of the screen.</p>
<p>Check the <code class="docutils literal"><span class="pre">on_touch_move</span></code> handler:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">on_touch_move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">touch</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">touch</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">/</span><span class="mi">3</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player1</span><span class="o">.</span><span class="n">center_y</span> <span class="o">=</span> <span class="n">touch</span><span class="o">.</span><span class="n">y</span>
    <span class="k">if</span> <span class="n">touch</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">/</span><span class="mi">3</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player2</span><span class="o">.</span><span class="n">center_y</span> <span class="o">=</span> <span class="n">touch</span><span class="o">.</span><span class="n">y</span>
</pre></div>
</td></tr></table></div>
<p>We&#8217;ll keep the score for each player in a
<code class="xref py py-class docutils literal"><span class="pre">NumericProperty</span></code>. The score labels of the <code class="docutils literal"><span class="pre">PongGame</span></code>
are kept updated by changing the NumericProperty <code class="docutils literal"><span class="pre">score</span></code>, which in turn
updates the <code class="docutils literal"><span class="pre">PongGame</span></code> child labels text property. This binding
occurs because Kivy <code class="xref py py-mod docutils literal"><span class="pre">properties</span></code> automatically bind to any references
in their corresponding kv files. When the ball
escapes out of the sides, we&#8217;ll update the score and serve the ball
again by changing the <code class="docutils literal"><span class="pre">update</span></code> method in the <code class="docutils literal"><span class="pre">PongGame</span></code> class. The <code class="docutils literal"><span class="pre">PongPaddle</span></code>
class also implements a <code class="docutils literal"><span class="pre">bounce_ball</span> <span class="pre">method</span></code>, so that the ball bounces
differently based on where it hits the racket. Here is the code for the
<cite>PongPaddle</cite> class:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PongPaddle</span><span class="p">(</span><span class="n">Widget</span><span class="p">):</span>

    <span class="n">score</span> <span class="o">=</span> <span class="n">NumericProperty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">bounce_ball</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ball</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collide_widget</span><span class="p">(</span><span class="n">ball</span><span class="p">):</span>
            <span class="n">speedup</span>  <span class="o">=</span> <span class="mf">1.1</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mf">0.02</span> <span class="o">*</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ball</span><span class="o">.</span><span class="n">center_y</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">center_y</span><span class="p">)</span>
            <span class="n">ball</span><span class="o">.</span><span class="n">velocity</span> <span class="o">=</span>  <span class="n">speedup</span> <span class="o">*</span> <span class="p">(</span><span class="n">offset</span> <span class="o">-</span> <span class="n">ball</span><span class="o">.</span><span class="n">velocity</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">This algorithm for ball bouncing is very simple, but will have strange behavior
if the ball hits the paddle from the side or bottom...this is something you could
try to fix yourself if you like.</p>
</div>
<p>And here it is in context. Pretty much done:</p>
<dl class="docutils">
<dt>main.py:</dt>
<dd><div class="first last highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kivy.app</span> <span class="kn">import</span> <span class="n">App</span>
<span class="kn">from</span> <span class="nn">kivy.uix.widget</span> <span class="kn">import</span> <span class="n">Widget</span>
<span class="kn">from</span> <span class="nn">kivy.properties</span> <span class="kn">import</span> <span class="n">NumericProperty</span><span class="p">,</span> <span class="n">ReferenceListProperty</span><span class="p">,</span>\
    <span class="n">ObjectProperty</span>
<span class="kn">from</span> <span class="nn">kivy.vector</span> <span class="kn">import</span> <span class="n">Vector</span>
<span class="kn">from</span> <span class="nn">kivy.clock</span> <span class="kn">import</span> <span class="n">Clock</span>


<span class="k">class</span> <span class="nc">PongPaddle</span><span class="p">(</span><span class="n">Widget</span><span class="p">):</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">NumericProperty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">bounce_ball</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ball</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collide_widget</span><span class="p">(</span><span class="n">ball</span><span class="p">):</span>
            <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="n">ball</span><span class="o">.</span><span class="n">velocity</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">ball</span><span class="o">.</span><span class="n">center_y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">center_y</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">bounced</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">)</span>
            <span class="n">vel</span> <span class="o">=</span> <span class="n">bounced</span> <span class="o">*</span> <span class="mf">1.1</span>
            <span class="n">ball</span><span class="o">.</span><span class="n">velocity</span> <span class="o">=</span> <span class="n">vel</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">vel</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">offset</span>


<span class="k">class</span> <span class="nc">PongBall</span><span class="p">(</span><span class="n">Widget</span><span class="p">):</span>
    <span class="n">velocity_x</span> <span class="o">=</span> <span class="n">NumericProperty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">velocity_y</span> <span class="o">=</span> <span class="n">NumericProperty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">velocity</span> <span class="o">=</span> <span class="n">ReferenceListProperty</span><span class="p">(</span><span class="n">velocity_x</span><span class="p">,</span> <span class="n">velocity_y</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">velocity</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>


<span class="k">class</span> <span class="nc">PongGame</span><span class="p">(</span><span class="n">Widget</span><span class="p">):</span>
    <span class="n">ball</span> <span class="o">=</span> <span class="n">ObjectProperty</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
    <span class="n">player1</span> <span class="o">=</span> <span class="n">ObjectProperty</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
    <span class="n">player2</span> <span class="o">=</span> <span class="n">ObjectProperty</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">serve_ball</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vel</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">velocity</span> <span class="o">=</span> <span class="n">vel</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">move</span><span class="p">()</span>

        <span class="c1">#bounce of paddles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player1</span><span class="o">.</span><span class="n">bounce_ball</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player2</span><span class="o">.</span><span class="n">bounce_ball</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="p">)</span>

        <span class="c1">#bounce ball off bottom or top</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">velocity_y</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1">#went of to a side to score point?</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">player2</span><span class="o">.</span><span class="n">score</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">serve_ball</span><span class="p">(</span><span class="n">vel</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ball</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">player1</span><span class="o">.</span><span class="n">score</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">serve_ball</span><span class="p">(</span><span class="n">vel</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">on_touch_move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">touch</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">touch</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mi">3</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">player1</span><span class="o">.</span><span class="n">center_y</span> <span class="o">=</span> <span class="n">touch</span><span class="o">.</span><span class="n">y</span>
        <span class="k">if</span> <span class="n">touch</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mi">3</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">player2</span><span class="o">.</span><span class="n">center_y</span> <span class="o">=</span> <span class="n">touch</span><span class="o">.</span><span class="n">y</span>


<span class="k">class</span> <span class="nc">PongApp</span><span class="p">(</span><span class="n">App</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">game</span> <span class="o">=</span> <span class="n">PongGame</span><span class="p">()</span>
        <span class="n">game</span><span class="o">.</span><span class="n">serve_ball</span><span class="p">()</span>
        <span class="n">Clock</span><span class="o">.</span><span class="n">schedule_interval</span><span class="p">(</span><span class="n">game</span><span class="o">.</span><span class="n">update</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">60.0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">game</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">PongApp</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</dd>
</dl>
<p>pong.kv:</p>
<blockquote>
<div><div class="highlight-kv"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#:kivy 1.0.9</span>

<span class="nn">&lt;PongBall&gt;</span><span class="p">:</span>
    <span class="na">size</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span> 
    <span class="nc">canvas</span><span class="p">:</span>
        <span class="nc">Ellipse</span><span class="p">:</span>
            <span class="na">pos</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
            <span class="na">size</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>          

<span class="nn">&lt;PongPaddle&gt;</span><span class="p">:</span>
    <span class="na">size</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">200</span>
    <span class="nc">canvas</span><span class="p">:</span>
        <span class="nc">Rectangle</span><span class="p">:</span>
            <span class="na">pos</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
            <span class="na">size</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span>

<span class="nn">&lt;PongGame&gt;</span><span class="p">:</span>
    <span class="na">ball</span><span class="p">:</span> <span class="n">pong_ball</span>
    <span class="na">player1</span><span class="p">:</span> <span class="n">player_left</span>
    <span class="na">player2</span><span class="p">:</span> <span class="n">player_right</span>
    
    <span class="nc">canvas</span><span class="p">:</span>
        <span class="nc">Rectangle</span><span class="p">:</span>
            <span class="na">pos</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">center_x</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span>
            <span class="na">size</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>
    
    <span class="nc">Label</span><span class="p">:</span>
        <span class="na">font_size</span><span class="p">:</span> <span class="mi">70</span>  
        <span class="na">center_x</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mi">4</span>
        <span class="na">top</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">top</span> <span class="o">-</span> <span class="mi">50</span>
        <span class="na">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">player1</span><span class="o">.</span><span class="n">score</span><span class="p">)</span>
        
    <span class="nc">Label</span><span class="p">:</span>
        <span class="na">font_size</span><span class="p">:</span> <span class="mi">70</span>  
        <span class="na">center_x</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span>
        <span class="na">top</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">top</span> <span class="o">-</span> <span class="mi">50</span>
        <span class="na">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">player2</span><span class="o">.</span><span class="n">score</span><span class="p">)</span>
    
    <span class="nc">PongBall</span><span class="p">:</span>
        <span class="na">id</span><span class="p">:</span> <span class="n">pong_ball</span>
        <span class="na">center</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">center</span>
        
    <span class="nc">PongPaddle</span><span class="p">:</span>
        <span class="na">id</span><span class="p">:</span> <span class="n">player_left</span>
        <span class="na">x</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">x</span>
        <span class="na">center_y</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">center_y</span>
        
    <span class="nc">PongPaddle</span><span class="p">:</span>
        <span class="na">id</span><span class="p">:</span> <span class="n">player_right</span>
        <span class="na">x</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">width</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span>
        <span class="na">center_y</span><span class="p">:</span> <span class="n">root</span><span class="o">.</span><span class="n">center_y</span>
        
</pre></div>
</td></tr></table></div>
</div></blockquote>
</div>
<div class="section" id="where-to-go-now">
<h2>Where To Go Now?<a class="headerlink" href="#where-to-go-now" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="title container">
Have some fun</div>
<p>Well, the pong game is pretty much complete. If you understood all of the
things that are covered in this tutorial, give yourself a pat on the back and
think about how you could improve the game. Here are a few ideas of things
you could do:</p>
<ul class="simple">
<li>Add some nicer graphics / images. (Hint: check out the
<code class="xref py py-attr docutils literal"><span class="pre">source</span></code> property on
the graphics instructions like <code class="xref py py-attr docutils literal"><span class="pre">circle</span></code> or
<code class="xref py py-class docutils literal"><span class="pre">Rectangle</span></code>, to set an image as the
texture.)</li>
<li>Make the game end after a certain score. Maybe once a player has 10
points, you can display a large &#8220;PLAYER 1 WINS&#8221; label and/or add a main menu
to start, pause and reset the game. (Hint: check out the
<code class="xref py py-class docutils literal"><span class="pre">Button</span></code> and
<code class="xref py py-class docutils literal"><span class="pre">Label</span></code>
classes, and figure out how to use their <cite>add_widget</cite> and <cite>remove_widget</cite>
functions to add or remove widgets dynamically.</li>
<li>Make it a 4 player Pong Game.  Most tablets have Multi-Touch support, so
wouldn&#8217;t it be cool to have a player on each side and have four
people play at the same time?</li>
<li>Fix the simplistic collision check so hitting the ball with an end of
the paddle results in a more realistic bounce.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">You can find the entire source code and source code files for each step in
the Kivy examples directory under tutorials/pong/</p>
</div>
</div>
</div>


            <div class="footerlinks">
            <table>
                <tr>
                    <td class="leftlink">
                  <a href="../tutorials-index.html" title="previous chapter">&laquo; Tutorials</a></li>
                  </td>
                  <td class="rightlink">
                  <a href="firstwidget.html" title="next chapter">A Simple Paint App(翻訳中) &raquo;</a>
                      </td>
                  </tr>
              </table>
              </div>
          </div>
        </div>
      </div>
      </div>
      <div class="clearer"></div>
    </div>
    </div>
<!-- Piwik --> 
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://txzone.net/piwik/" : "http://txzone.net/piwik/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 8);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="https://txzone.net/piwik/piwik.php?idsite=8" style="border:0" alt="" /></p></noscript>
<!-- End Piwik Tracking Code -->
    <!--
    <div class="footer">
      &copy; Copyright 2010, The Kivy Authors.
      Last updated on 10月 09, 2016.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.8.
</div>
-->
  </body>
</html>