<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="twitter:site" content="@kivyframework">
    
    <title>Create a package for Windows（翻訳済み） &mdash; Kivy 1.9.1 ドキュメント</title>
    <link href='//fonts.googleapis.com/css?family=Source+Code+Pro:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="../_static/fresh.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.9.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/jquery-effects-core-and-slide.js"></script>
    <script type="text/javascript" src="../_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="../_static/kivy.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="Kivy 1.9.1 ドキュメント" href="../index.html" />
    <link rel="up" title="Packaging your application(翻訳中)" href="packaging.html" />
    <link rel="next" title="Create a package for Android(翻訳済み)" href="packaging-android.html" />
    <link rel="prev" title="Packaging your application(翻訳中)" href="packaging.html" /> 
  </head>
  <body>

    <div id="topbar">
        <div id="topwrapper">
        <div id="toplogo">
            <a href="http://kivy.org/">
                <img src="../_static/logo-kivy.png" alt="Kivy" height="50"/>
            </a>
        </div>
        <div id="topmenu">
            <ul class="navigation">
                <li><a class="nav-guides" href="../gettingstarted/intro.html">Guides</a></li>
                <li><a class="nav-garden" href="http://kivy-garden.github.io/">Garden</a></li>
                <li><a class="nav-api" href="../api-kivy.html">API Reference</a></li>
                <li><a class="nav-pdf" href="http://kivy.org/docs/pdf/Kivy-latest.pdf">PDF</a></li>
                <li><a class="nav-wiki" href="http://wiki.kivy.org">Wiki</a></li>
            </ul>
        </div>
        </div>
    </div>
<div id="contentall">
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3>Quick search</h3>
            <form class="search" action="../search.html" method="get">
                &nbsp;
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
                <input type="text" class="text" name="q" />
            </form>
          <!--
          <h3><a href="../index.html">Create a package for Windows（翻訳済み）</a></h3>
          <ul>
<li><a class="reference internal" href="#">Create a package for Windows（翻訳済み）</a><ul>
<li><a class="reference internal" href="#requirements">Requirements(要件)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyinstaller-default-hook">PyInstaller default hook(PyInstallerのデフォルトhookについて)</a><ul>
<li><a class="reference internal" href="#packaging-a-simple-app">Packaging a simple app(シンプルなアプリのパッケージ化)</a></li>
<li><a class="reference internal" href="#packaging-a-video-app-with-gstreamer">Packaging a video app with gstreamer(gstreamerのビデオアプリをパッケージ化)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#overwriting-the-default-hook">Overwriting the default hook(デフォルトhookを上書きします)</a><ul>
<li><a class="reference internal" href="#including-excluding-video-and-audio-and-reducing-app-size">Including/excluding video and audio and reducing app size（Videoとaudioを引き込む、のぞくことでアプリのサイズを縮小する）</a></li>
<li><a class="reference internal" href="#alternate-installations">Alternate installations(インストールの代替)</a></li>
</ul>
</li>
</ul>

          <h3><a href="../index.html">Table Of Contents</a></h3>
          -->
          <ul>
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted/index.html">Getting Started(翻訳中)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/intro.html">導入</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/installation.html">インストール</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/first_app.html">最初のアプリ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/properties.html">プロパティ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/rules.html">Kv デザイン 言語</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/events.html">イベント</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/framework.html">Non-widget stuff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/layouts.html">Layouts(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/drawing.html">描画</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/packaging.html">Packaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/examples.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gettingstarted/diving.html">ダイビング</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Gallery of Examples(翻訳済み)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/gallery.html">Gallery(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__3Drendering__main__py.html">3D Rotating Monkey Head(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__animation__animate__py.html">Widget animation(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__application__app_suite__py.html">Suite of Application Builders(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__application__app_with_build__py.html">Application example using build() + return(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__application__app_with_kv__py.html">Application built from a  .kv fil(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__application__app_with_kv_in_template1__py.html">Application from a .kv in a Template Directory(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__camera__main__py.html">Camera Example(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__bezier__py.html">Bezier Example(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__canvas_stress__py.html">Canvas stress(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__circle__py.html">Circle Example(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__fbo_canvas__py.html">FBO Canvas(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__lines__py.html">Line (SmoothLine) Experiment(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__lines_extended__py.html">Lines Extended Demo(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__mesh__py.html">Mesh test(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__multitexture__py.html">Multitexture Example(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__repeat_texture__py.html">Repeat Texture on Resize(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__rotation__py.html">Rotation Example(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__stencil_canvas__py.html">Stencil demo(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__tesselate__py.html">Tesselate Demonstration(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__canvas__texture__py.html">Texture Wrapping and Coordinates Example(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__demo__camera_puzzle__py.html">Shuffled Camera Feed Puzzle(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__demo__kivycatalog__main__py.html">Kivy Catalog(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__demo__multistroke__main__py.html">Multistroke Recognition Database Demonstration(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__demo__pictures__main__py.html">Basic Picture Viewer(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__demo__shadereditor__main__py.html">Live Shader Editor(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__demo__showcase__main__py.html">Showcase of Kivy Features(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/gen__demo__touchtracer__main__py.html">Touch Tracer Line Drawing Demonstration(翻訳済み)</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user-guide.html">User’s Guide(翻訳中)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation/installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../philosophy.html">Philosophy(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute.html">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contact.html">Contact Us</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../guide-index.html">Programming Guide(翻訳中)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="basic.html">Kivyの基本</a></li>
<li class="toctree-l2"><a class="reference internal" href="environment.html">Controlling the environment(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html">Configure Kivy(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">Architectural Overview(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="events.html">Events and Properties (翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="inputs.html">Input management</a></li>
<li class="toctree-l2"><a class="reference internal" href="widgets.html">Widgets(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="graphics.html">Graphics (翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="lang.html">Kv language(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="other-frameworks.html">Integrating with other Frameworks(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="bestpractices.html">Best Practices(翻訳済み)</a></li>
<li class="toctree-l2"><a class="reference internal" href="advancedgraphics.html">Advanced Graphics(翻訳済み)</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="packaging.html">Packaging your application(翻訳中)</a></li>
<li class="toctree-l2"><a class="reference internal" href="licensing.html">Package licensing(未翻訳)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials-index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/pong.html">Pong Game Tutorial(翻訳中)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/firstwidget.html">A Simple Paint App(翻訳中)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/crashcourse.html">Crash Course</a></li>
</ul>
</li>
</ul>

          <!--
          <h3>Related Topics</h3>
          <ul>
              <li>Previous: <a href="packaging.html" title="previous chapter">Packaging your application(翻訳中)</a></li>
              <li>Next: <a href="packaging-android.html" title="next chapter">Create a package for Android(翻訳済み)</a></li>
          </ul>
          -->
        </div>
      </div>
    <div id="content">
    <div class="wrapper">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            <div class="toc"><h2>Table Of Contents</h2><ul>
<li><a class="reference internal" href="#">Create a package for Windows（翻訳済み）</a><ul>
<li><a class="reference internal" href="#requirements">Requirements(要件)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pyinstaller-default-hook">PyInstaller default hook(PyInstallerのデフォルトhookについて)</a><ul>
<li><a class="reference internal" href="#packaging-a-simple-app">Packaging a simple app(シンプルなアプリのパッケージ化)</a></li>
<li><a class="reference internal" href="#packaging-a-video-app-with-gstreamer">Packaging a video app with gstreamer(gstreamerのビデオアプリをパッケージ化)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#overwriting-the-default-hook">Overwriting the default hook(デフォルトhookを上書きします)</a><ul>
<li><a class="reference internal" href="#including-excluding-video-and-audio-and-reducing-app-size">Including/excluding video and audio and reducing app size（Videoとaudioを引き込む、のぞくことでアプリのサイズを縮小する）</a></li>
<li><a class="reference internal" href="#alternate-installations">Alternate installations(インストールの代替)</a></li>
</ul>
</li>
</ul>
</div>
            
  <div class="section" id="create-a-package-for-windows">
<h1>Create a package for Windows（翻訳済み）<a class="headerlink" href="#create-a-package-for-windows" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">この文章はkivy <code class="docutils literal"><span class="pre">1.9.1</span></code> 以降のバージョンが対象です。</p>
</div>
<p>Windowsプラットフォーム用のアプリケーションのパッケージは、Windows OS内でできます。次のプロセスはKivy wheelsのインストールをwindowsにインストールし、インストールの終了までテストされています。</p>
<p>パッケージは実行したPythonのバージョンに応じて32bit,64bitのどちらかになります。</p>
<div class="section" id="requirements">
<span id="packaging-windows-requirements"></span><h2>Requirements(要件)<a class="headerlink" href="#requirements" title="このヘッドラインへのパーマリンク">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><p class="first">Kivyの最新バージョン（ <a class="reference internal" href="../installation/installation-windows.html#installation-windows"><span class="std std-ref">Installation on Windows</span></a> の記載の通りインストール ）。</p>
</li>
<li><p class="first">PyInstallerは3.1以上 (<code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--upgrade</span> <span class="pre">pyinstaller</span></code>)</p>
</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="pyinstaller-default-hook">
<span id="create-the-spec-file"></span><h1>PyInstaller default hook(PyInstallerのデフォルトhookについて)<a class="headerlink" href="#pyinstaller-default-hook" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>このセクションでは、kivyフックを含むためpyInstallerの（&gt; = 3.1）に適用されます。デフォルトのフックを上書きするには次の例のように少し修正する必要があります。 「 <a class="reference internal" href="#overwrite-win-hook"><span class="std std-ref">Overwriting the default hook(デフォルトhookを上書きします)</span></a> 」を参照してください。</p>
<div class="section" id="packaging-a-simple-app">
<h2>Packaging a simple app(シンプルなアプリのパッケージ化)<a class="headerlink" href="#packaging-a-simple-app" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>この例では、touchtracerサンプルプロジェクトをパッケージ化し、カスタムアイコンを埋め込みます。wheelを使用してインストールしている場合、kivyのサンプルコードの場所は <code class="docutils literal"><span class="pre">python\\share\\kivy-examples</span></code> にgithubのソースコードをインストールして使用するときは <cite>kivy\examples`</cite> にあります 。サンプルコードに至る絶対パスexamples-pathパスを参照します。touchtracerの例があるexamples-pathdemotouchtracerとメインファイルは``main.py``です。</p>
<ol class="arabic">
<li><p class="first">コマンドラインシェルを開き、pythonのパス（<a href="#id1"><span class="problematic" id="id2">``</span></a>python``上にある)</p>
</li>
<li><p class="first">パッケージ化するアプリを作成するフォルダを作成します。例えば``TouchApp`` フォルダを作成し、  <a href="#id1"><span class="problematic" id="id2">``</span></a>cd TouchApp``のように入力してその`ディレクトリに移動します&lt;<a class="reference external" href="http://www.computerhope.com/cdhlp.htm">http://www.computerhope.com/cdhlp.htm</a>&gt;`。以下のように入力します</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">PyInstaller</span> <span class="o">--</span><span class="n">name</span> <span class="n">touchtracer</span> <span class="n">examples</span><span class="o">-</span><span class="n">path</span>\<span class="n">demo</span>\<span class="n">touchtracer</span>\<span class="n">main</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>また、実行可能ファイルのアイコンを作成するために、アプリケーションフォルダに <cite>icon.ico</cite> ファイルを追加することができます。利用可能な.icoファイルがない場合は、Webアプリケーションの`ConvertICO &lt;<a class="reference external" href="http://www.convertico.com">http://www.convertico.com</a>&gt;`を使用してicon.pngファイルを変換することができます。touchtracerディレクトリに <cite>icon.ico</cite> を保存して入力します:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">PyInstaller</span> <span class="o">--</span><span class="n">name</span> <span class="n">touchtracer</span> <span class="o">--</span><span class="n">icon</span> <span class="n">examples</span><span class="o">-</span><span class="n">path</span>\<span class="n">demo</span>\<span class="n">touchtracer</span>\<span class="n">icon</span><span class="o">.</span><span class="n">ico</span> <span class="n">examples</span><span class="o">-</span><span class="n">path</span>\<span class="n">demo</span>\<span class="n">touchtracer</span>\<span class="n">main</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>より多くのオプションについては、<a href="#id1"><span class="problematic" id="id2">`</span></a>pyInstallerのマニュアル&lt;<a class="reference external" href="http://pythonhosted.org/PyInstaller/">http://pythonhosted.org/PyInstaller/</a>&gt;`を参照してください 。</p>
</li>
<li><p class="first">The spec file will be <code class="docutils literal"><span class="pre">touchtracer.spec</span></code> located in <code class="docutils literal"><span class="pre">TouchApp</span></code>. Now we need to
edit the spec file to add the dependencies hooks to correctly build the exe.
Open the spec file with your favorite editor and add these lines at the
beginning of the spec (assuming sdl2 is used, the default now):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kivy.deps</span> <span class="k">import</span> <span class="n">sdl2</span><span class="p">,</span> <span class="n">glew</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">COLLECT()</span></code> にtouchtracerのデータ（<cite>touchtracer.kv</cite>, <cite>particle.png</cite>、...）を追加します。<code class="docutils literal"><span class="pre">Tree()``オブジェクトに追加する行を加えます（例：``Tree('examples-path\\demo\\touchtracer\\')）</span></code>。Treeはtouchtracerディレクトリにあるすべてのファイルを検索して最終的なパッケージに追加します。</p>
<p>COLLECT依存関係の最初のキーワード引数の前にTreeオブジェクトのすべてのパスに依存関係を追加します。 例えば``*[Tree(p) for p in (sdl2.dep_bins + glew.dep_bins)]`` の場合は次のようになります：</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">coll</span> <span class="o">=</span> <span class="n">COLLECT</span><span class="p">(</span><span class="n">exe</span><span class="p">,</span> <span class="n">Tree</span><span class="p">(</span><span class="s1">&#39;examples-path</span><span class="se">\\</span><span class="s1">demo</span><span class="se">\\</span><span class="s1">touchtracer</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">),</span>
               <span class="n">a</span><span class="o">.</span><span class="n">binaries</span><span class="p">,</span>
               <span class="n">a</span><span class="o">.</span><span class="n">zipfiles</span><span class="p">,</span>
               <span class="n">a</span><span class="o">.</span><span class="n">datas</span><span class="p">,</span>
               <span class="o">*</span><span class="p">[</span><span class="n">Tree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">(</span><span class="n">sdl2</span><span class="o">.</span><span class="n">dep_bins</span> <span class="o">+</span> <span class="n">glew</span><span class="o">.</span><span class="n">dep_bins</span><span class="p">)],</span>
               <span class="n">strip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">upx</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">name</span><span class="o">=</span><span class="s1">&#39;touchtracer&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">今、<code class="docutils literal"><span class="pre">TouchApp</span></code> のspecファイルをビルドします:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">PyInstaller</span> <span class="n">touchtracer</span><span class="o">.</span><span class="n">spec</span>
</pre></div>
</div>
</li>
<li><p class="first">コンパイルされたパッケージは <a href="#id1"><span class="problematic" id="id2">`</span></a>TouchApp\dist\touchtracer`ディレクトリに生成されます。</p>
</li>
</ol>
</div>
<div class="section" id="packaging-a-video-app-with-gstreamer">
<h2>Packaging a video app with gstreamer(gstreamerのビデオアプリをパッケージ化)<a class="headerlink" href="#packaging-a-video-app-with-gstreamer" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>後はビデオ用のgstreamerを使用するアプリケーションをパッケージ化するために上記の例を少し修正します。使用する <code class="docutils literal"><span class="pre">videoplayer</span></code> は``examples-pathwidgetsvideoplayer.py`` にありますVideoPlayerフォルダを作成してコマンドラインでそのフォルダにカレントディレクトリを変更し次を実行します:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">PyInstaller</span> <span class="o">--</span><span class="n">name</span> <span class="n">gstvideo</span> <span class="n">examples</span><span class="o">-</span><span class="n">path</span>\<span class="n">widgets</span>\<span class="n">videoplayer</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">gstvideo.spec</span></code> ファイルを作成します。そのうえで、この時gstreamerをインクルードするように編集してください。</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kivy.deps</span> <span class="k">import</span> <span class="n">sdl2</span><span class="p">,</span> <span class="n">glew</span><span class="p">,</span> <span class="n">gstreamer</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">Tree()</span></code> にビデオファイルをインクルードしたように追加をします。gstreamerの依存関係と同様に <code class="docutils literal"><span class="pre">Tree('examples-path\\widgets')</span></code> にこのように追加します。</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">coll</span> <span class="o">=</span> <span class="n">COLLECT</span><span class="p">(</span><span class="n">exe</span><span class="p">,</span> <span class="n">Tree</span><span class="p">(</span><span class="s1">&#39;examples-path</span><span class="se">\\</span><span class="s1">widgets&#39;</span><span class="p">),</span>
               <span class="n">a</span><span class="o">.</span><span class="n">binaries</span><span class="p">,</span>
               <span class="n">a</span><span class="o">.</span><span class="n">zipfiles</span><span class="p">,</span>
               <span class="n">a</span><span class="o">.</span><span class="n">datas</span><span class="p">,</span>
               <span class="o">*</span><span class="p">[</span><span class="n">Tree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">(</span><span class="n">sdl2</span><span class="o">.</span><span class="n">dep_bins</span> <span class="o">+</span> <span class="n">glew</span><span class="o">.</span><span class="n">dep_bins</span> <span class="o">+</span> <span class="n">gstreamer</span><span class="o">.</span><span class="n">dep_bins</span><span class="p">)],</span>
               <span class="n">strip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">upx</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">name</span><span class="o">=</span><span class="s1">&#39;gstvideo&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">VideoPlayer</span></code> のspecファイルをビルドします。</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">PyInstaller</span> <span class="n">gstvideo</span><span class="o">.</span><span class="n">spec</span>
</pre></div>
</div>
<p>ビデオを再生するときには <a href="#id1"><span class="problematic" id="id2">``</span></a>VideoPlayerdistgstvideo``のgstvideo.exeが存在する必要があります。</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p>Pygameを使用していて、アプリのパッケージにPygameが必要な場合は、 kivy issue #1638にあるようにspecファイルに次のコードを追加してください。importの後に追加します:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getResource</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">identifier</span> <span class="o">==</span> <span class="s1">&#39;pygame_icon.tiff&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">_original_getResource</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">pygame.pkgdata</span>
<span class="n">_original_getResource</span> <span class="o">=</span> <span class="n">pygame</span><span class="o">.</span><span class="n">pkgdata</span><span class="o">.</span><span class="n">getResource</span>
<span class="n">pygame</span><span class="o">.</span><span class="n">pkgdata</span><span class="o">.</span><span class="n">getResource</span> <span class="o">=</span> <span class="n">getResource</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="overwriting-the-default-hook">
<span id="overwrite-win-hook"></span><h1>Overwriting the default hook(デフォルトhookを上書きします)<a class="headerlink" href="#overwriting-the-default-hook" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="section" id="including-excluding-video-and-audio-and-reducing-app-size">
<h2>Including/excluding video and audio and reducing app size（Videoとaudioを引き込む、のぞくことでアプリのサイズを縮小する）<a class="headerlink" href="#including-excluding-video-and-audio-and-reducing-app-size" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>PyInstallerのデフォルトはkivy、例えばオーディオ、ビデオ、スペルなど使用される <a href="#id1"><span class="problematic" id="id2">**</span></a>すべての**のコアモジュールをhookに追加します。（ツリー（）を使用して手動でgstreamerのDLLをパッケージ化する必要があります - 下記の例を参照してください。）。フックがインストールされていないか、オーディオ/ビデオを使用しない場合でアプリケーションサイズを縮小する場合は、これらのモジュールのいくつかは、別のフックにするか、除外してもよいです</p>
<p>Kivyは:func:<a href="#id1"><span class="problematic" id="id2">`</span></a>~kivy.tools.packaging.pyinstaller_hooks.hookspath`で代替hookを提供します 。 PyInstallerのデフォルトのhookがない場合に限り、:func:<a href="#id3"><span class="problematic" id="id4">`</span></a>~kivy.tools.packaging.pyinstaller_hooks.runtime_hooks`も提供されなければなりません。 hookを上書きするときに、 runtime_hooks()は通常は上書きする必要はありません。</p>
<p><code class="xref py py-func docutils literal"><span class="pre">hookspath()</span></code> の代替hockはkivyプロバイダのどれかが含まれてません。追加するには、<code class="xref py py-func docutils literal"><span class="pre">get_deps_all()</span></code> で追加する必要があります。詳細については、 get_deps_minimal()と get_deps_all()ドキュメントと:mod:<cite>~kivy.tools.packaging.pyinstaller_hooks</cite> を参照してください。しかしながら本質的には、<code class="xref py py-func docutils literal"><span class="pre">get_deps_all()</span></code> でデフォルトhookにすべてのプロバイダを追加するか:func:<cite>~kivy.tools.packaging.pyinstaller_hooks.get_deps_minimal</cite> でアプリの実行時にロードされているものを追加します。それぞれの方法は、<a href="#id1"><span class="problematic" id="id2">``</span></a>Analysis``に渡せます。そしてkivyの隠れたimport、または除外されたimportのリストを提供します。</p>
<p>1つの方法は、文字通りすべてのkivyプロバイダモジュールをリスト化し、必要でないものはコメントアウトして代替hookを生成します。<code class="xref py py-mod docutils literal"><span class="pre">pyinstaller_hooks</span></code> を参照してください。</p>
<p>上記の例と代替hookにhookを追加するには、次のように``hookspath()`` と <code class="docutils literal"><span class="pre">runtime_hooks</span></code>  （必要な場合）と``**get_deps_minimal()``または``**get_deps_all()``プロバイダを指定して使用します。</p>
<p>For example, add the import statement
<code class="docutils literal"><span class="pre">from</span> <span class="pre">kivy.tools.packaging.pyinstaller_hooks</span> <span class="pre">import</span>&#160; <span class="pre">get_deps_minimal,</span>
<span class="pre">get_deps_all,</span> <span class="pre">hookspath,</span> <span class="pre">runtime_hooks</span></code>
and then modify <code class="docutils literal"><span class="pre">Analysis</span></code> as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">Analysis</span><span class="p">([</span><span class="s1">&#39;examples-path</span><span class="se">\\</span><span class="s1">demo</span><span class="se">\\</span><span class="s1">touchtracer</span><span class="se">\\</span><span class="s1">main.py&#39;</span><span class="p">],</span>
             <span class="o">...</span>
             <span class="n">hookspath</span><span class="o">=</span><span class="n">hookspath</span><span class="p">(),</span>
             <span class="n">runtime_hooks</span><span class="o">=</span><span class="n">runtime_hooks</span><span class="p">(),</span>
             <span class="o">...</span>
             <span class="o">**</span><span class="n">get_deps_all</span><span class="p">())</span>
</pre></div>
</div>
<p>デフォルトhookのようにすべてもの含めます。 または:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">Analysis</span><span class="p">([</span><span class="s1">&#39;examples-path</span><span class="se">\\</span><span class="s1">demo</span><span class="se">\\</span><span class="s1">touchtracer</span><span class="se">\\</span><span class="s1">main.py&#39;</span><span class="p">],</span>
             <span class="o">...</span>
             <span class="n">hookspath</span><span class="o">=</span><span class="n">hookspath</span><span class="p">(),</span>
             <span class="n">runtime_hooks</span><span class="o">=</span><span class="n">runtime_hooks</span><span class="p">(),</span>
             <span class="o">...</span>
             <span class="o">**</span><span class="n">get_deps_minimal</span><span class="p">(</span><span class="n">video</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">audio</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
</pre></div>
</div>
<p>例えば、audioとvideoのプロバイダーを除外し、他のコアモジュールで使用されるプロパイダーだけがロードされて使用します。</p>
<p>キーポイントは、代替を提供する <code class="xref py py-func docutils literal"><span class="pre">hookspath()</span></code> を:func:<a href="#id1"><span class="problematic" id="id2">`</span></a>~kivy.tools.packaging.pyinstaller_hooks.get_deps_minimal`で除去し、</p>
</div>
<div class="section" id="alternate-installations">
<h2>Alternate installations(インストールの代替)<a class="headerlink" href="#alternate-installations" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>前の例は、<code class="docutils literal"><span class="pre">*[Tree(p)</span> <span class="pre">for</span> <span class="pre">p</span> <span class="pre">in</span> <span class="pre">(sdl2.dep_bins</span> <span class="pre">+</span> <span class="pre">glew.dep_bins</span> <span class="pre">+</span> <span class="pre">gstreamer.dep_bins)],</span></code> を使用する場合 pyInstallerでの作成ですべてのDLLを追加し、依存関係で使用されます。 kivy wheel メソッドを使用してインストールされていない場合、これらのコマンドは動作しませんし、例えば``kivy.deps.sdl2`` のimportに失敗します。その代わりに、一つの方法としてはこれらのDLLの場所を見つけて``Tree`クラスの例と同様の方法で手動に渡す必要があります。</p>
</div>
</div>


            <div class="footerlinks">
            <table>
                <tr>
                    <td class="leftlink">
                  <a href="packaging.html" title="previous chapter">&laquo; Packaging your application(翻訳中)</a></li>
                  </td>
                  <td class="rightlink">
                  <a href="packaging-android.html" title="next chapter">Create a package for Android(翻訳済み) &raquo;</a>
                      </td>
                  </tr>
              </table>
              </div>
          </div>
        </div>
      </div>
      </div>
      <div class="clearer"></div>
    </div>
    </div>
<!-- Piwik --> 
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://txzone.net/piwik/" : "http://txzone.net/piwik/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 8);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="https://txzone.net/piwik/piwik.php?idsite=8" style="border:0" alt="" /></p></noscript>
<!-- End Piwik Tracking Code -->
    <!--
    <div class="footer">
      &copy; Copyright 2010, The Kivy Authors.
      Last updated on 10月 09, 2016.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.8.
</div>
-->
  </body>
</html>